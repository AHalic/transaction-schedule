# Cria o grafo

edges = []

transactions = (SELECT * from t1, t2 where t2.time == t1.time + 1)

(1, 1,  'R',  'X'),
(2, 2,  'R',  'Y'),
(3, 3,  'W',  'X'),
(4, 2,  'W',  'X'),
(5, 1,  'W',  'X'),
(6, 2,  'C',  '-'),
(7, 1,  'C',  '-');

#TODO melhorar criacao do grafo
# caso em que o conflito seria entre a primeira e terceira linha (t1 e t3)

se trans1=trans2 entao pula
senao entao verifica a operacao.
    se operacao de conflito entao verifica attr
        se attr diferentes entao pula
        senao cria aresta
    senao pula


# Verifica ciclo

nodes_visited = []

for tupla in edges:

    temp3 = tupla

    if not tupla in nodes_visited:
        nodes_visited.append(tupla)
    
        while True:
            temp1 = temp3
            temp_filtro = (SELECT * FROM temp1 e1, Edges e2 where e1.to_node = e2.from_node)
        
            if temp_filtro == None:
                break

            temp2 = (SELECT e1.from_node, e2.to_node from temp1 e1 join temp_filtro e2 on e1.to_node = e2.from_node)
            temp3 = temp2 - nodes_visited

            if temp3 == None or temp3.from_node = temp3.to_node:
                return 1
                
            nodes_visited = unique(nodes_visited + temp2 + temp_filtro)
       
return 0